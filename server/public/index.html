<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>18+ –í—Ö–æ–¥ ‚Äî –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="format-detection" content="telephone=no">

<script>
  window.__API_BASE = (typeof location !== 'undefined' && location.origin)
    ? location.origin.replace(/\/+$/, '')
    : '';
</script>

<style>
:root{
  --txt:#111;--sub:#444;--muted:#6b7280;
  --primary:#2563eb;--primary2:#60a5fa;
  --err:#ef4444;--ok:#16a34a;
  --radius:20px;--shadow:0 6px 28px rgba(0,0,0,.08);
  --gold-h:47;
}

/* –±–∞–∑–æ–≤–∞—è —Å—Ü–µ–Ω–∞ */
html,body{height:100%}
body{
  margin:0;overflow:hidden;display:grid;place-items:center;
  font-family:"SF Pro Display","Segoe UI",Roboto,system-ui,-apple-system,sans-serif;
  color:var(--txt);background:#f7f8fa;-webkit-font-smoothing:antialiased;
}

/* –≥–∏—Ä–ª—è–Ω–¥–∞ */
.ny-garland{
  position:fixed;top:8px;left:50%;transform:translateX(-50%);
  display:flex;gap:8px;z-index:1;pointer-events:none;
  filter:drop-shadow(0 2px 4px rgba(0,0,0,.06));
}
.bulb{width:8px;height:12px;border-radius:3px 3px 6px 6px;background:currentColor;opacity:.9;
  box-shadow:0 0 8px currentColor,0 0 14px currentColor;transform-origin:top center;transform:rotate(var(--r,5deg));
  animation:twinkle var(--t,2.4s) ease-in-out infinite}
.bulb:nth-child(4n+1){color:#ef4444;--t:2.6s;--r:6deg}
.bulb:nth-child(4n+2){color:#22c55e;--t:2.2s;--r:-5deg}
.bulb:nth-child(4n+3){color:#3b82f6;--t:2.8s;--r:4deg}
.bulb:nth-child(4n){color:#eab308;--t:2.1s;--r:-6deg}
@keyframes twinkle{0%,100%{opacity:.65}50%{opacity:1}}

/* –±–ª–∏–∫–∏ */
.sparkles{position:fixed;inset:0;z-index:0;pointer-events:none}
.sparkles span{position:absolute;width:2px;height:2px;background:#fff;border-radius:50%;opacity:.8;filter:blur(.2px);animation:sparkle 6s linear infinite}
@keyframes sparkle{0%{transform:scale(.8);opacity:.4}50%{transform:scale(1.4);opacity:.9}100%{transform:scale(.8);opacity:.4}}

/* —Å—Ç–µ–∫–ª–æ */
.card{
  width:min(92vw,520px);padding:28px;border-radius:var(--radius);
  background:rgba(255,255,255,.65);
  backdrop-filter:blur(22px) saturate(160%);-webkit-backdrop-filter:blur(22px) saturate(160%);
  border:1px solid rgba(220,222,230,.65);box-shadow:var(--shadow);text-align:center;z-index:2;
}
h1{margin:0 0 12px;font-size:24px;font-weight:800;position:relative}
h1::before{content:"üéÑ";position:absolute;left:-28px;top:-2px;font-size:18px;opacity:.9}
p{font-size:16px;margin:0 0 18px;line-height:1.6}
.reason{font-size:13px;margin-top:8px;color:var(--muted);text-align:left}
.notice{font-size:12px;color:var(--muted);margin-top:14px}

/* –∫–Ω–æ–ø–∫–∞ */
button{width:100%;height:54px;border:none;border-radius:14px;background:#1f2937;color:#fff;font-weight:800;font-size:16px;cursor:pointer;transition:transform .12s ease,box-shadow .12s ease;box-shadow:0 10px 20px rgba(31,41,55,.1)}
button:active{transform:scale(.97)}

.ok{color:var(--ok);font-weight:700}
.err{color:var(--err);font-weight:700}

/* –ø–æ–¥–ø–∏—Å—å */
.signature{position:fixed;bottom:12px;left:50%;transform:translateX(-50%);padding:6px 12px;border-radius:999px;background:rgba(255,255,255,.65);border:1px solid rgba(235,237,242,.6);box-shadow:0 4px 16px rgba(0,0,0,.05);font-size:12px;color:#000;opacity:.85;letter-spacing:.5px;user-select:none;z-index:2}

/* —Å–Ω–µ–∂–∏–Ω–∫–∏ */
.fireflies{position:fixed;inset:0;z-index:0;pointer-events:none}
.flake{position:absolute;width:30px;height:30px;opacity:.95;animation:wave var(--dur,10s) ease-in-out infinite;
  filter:drop-shadow(0 0 3px hsla(var(--gold-h),90%,75%,.95)) drop-shadow(0 0 11px hsla(var(--gold-h),90%,70%,.55)) drop-shadow(0 0 22px hsla(var(--gold-h),90%,60%,.35));
  transition:left .9s cubic-bezier(.2,.8,.2,1), top .9s cubic-bezier(.2,.8,.2,1), transform .9s cubic-bezier(.2,.8,.2,1), opacity .25s ease}
.flake svg{width:100%;height:100%;stroke:hsla(var(--gold-h),100%,60%,.95);stroke-width:2.25;stroke-linecap:round;fill:none}
.flake.glow{filter:drop-shadow(0 0 6px hsla(var(--gold-h),100%,80%,1)) drop-shadow(0 0 14px hsla(var(--gold-h),100%,70%,.85)) drop-shadow(0 0 26px hsla(var(--gold-h),100%,65%,.55));opacity:1}
@keyframes wave{0%{transform:translate3d(0,0,0) rotate(0deg)}30%{transform:translate3d(12px,-16px,0) rotate(8deg)}60%{transform:translate3d(-16px,10px,0) rotate(-6deg)}100%{transform:translate3d(0,0,0) rotate(0deg)}}

/* —Å—É–≥—Ä–æ–±—ã */
.snow-hills{position:fixed;bottom:-1px;left:0;width:100%;z-index:1;pointer-events:none;opacity:.95;filter:drop-shadow(0 -2px 8px rgba(0,0,0,.04))}
</style>
</head>

<body>

<!-- –≥–∏—Ä–ª—è–Ω–¥–∞ -->
<div class="ny-garland" aria-hidden="true">
  <span class="bulb"></span><span class="bulb"></span><span class="bulb"></span>
  <span class="bulb"></span><span class="bulb"></span><span class="bulb"></span>
  <span class="bulb"></span><span class="bulb"></span><span class="bulb"></span>
  <span class="bulb"></span><span class="bulb"></span><span class="bulb"></span>
  <span class="bulb"></span><span class="bulb"></span><span class="bulb"></span>
</div>

<!-- –±–ª–∏–∫–∏ -->
<div class="sparkles" id="sparkles" aria-hidden="true"></div>

<!-- —Å–Ω–µ–∂–∏–Ω–∫–∏ -->
<div class="fireflies" id="fireflies"></div>

<!-- –∫–∞—Ä—Ç–æ—á–∫–∞ -->
<div class="card" id="card">
  <h1 id="title">–ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</h1>
  <p id="text">–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã‚Ä¶</p>
  <div class="reason" id="reason"></div>
  <button id="enterBtn" style="display:none;">–í–æ–π—Ç–∏ 18+</button>
  <div class="notice" id="note"></div>
</div>

<div class="signature">Created by <b>V7CK9LL</b></div>

<!-- —Å—É–≥—Ä–æ–±—ã -->
<svg class="snow-hills" viewBox="0 0 1200 140" preserveAspectRatio="none" aria-hidden="true">
  <path d="M0,80 C150,120 300,20 450,60 C600,100 750,0 900,40 C1050,80 1125,60 1200,40 L1200,140 L0,140 Z" fill="#fff"/>
</svg>

<!-- —Ç–≤–æ–π –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç -->
<script src="/app.js?v=13"></script>

<!-- DIAG: —Ñ–∏—á–µ-—Ç–µ—Å—Ç—ã –∏–¥—É—Ç –ü–ï–†–í–´–ú–ò –∏ –ø–∏–Ω—è—Ç—Å—è –∫ UI -->
<script>
(function(){
  const UI = {
    t:  document.getElementById('title'),
    p:  document.getElementById('text'),
    r:  document.getElementById('reason'),
    n:  document.getElementById('note'),
    btn:document.getElementById('enterBtn'),
  };

  function ok(b){return b ? 'ok' : '‚Äî';}

  // --- Safari 18.0: View Transitions ---
  async function testVT18(){
    const hasAPI = typeof document.startViewTransition === 'function';
    const cssOK  = typeof CSS?.supports === 'function' && CSS.supports('view-transition-name: auto') === true;
    let ran=false, finished=false;
    try{
      if(hasAPI){
        const div=document.createElement('div'); div.textContent='A'; document.body.appendChild(div);
        const vt=document.startViewTransition(()=>{ div.textContent='B'; ran=true; });
        await vt?.finished; finished=true; div.remove();
      }
    }catch{}
    return { pass: !!(hasAPI && cssOK && ran && finished), details:{hasAPI, cssOK, ran, finished} };
  }

  // --- Safari 18.4: shape()+CookieStore+WebAuthn JSON ---
  async function test184(){
    let shapeOK=false;
    try{ const el=document.createElement('div');
         el.style.clipPath='shape(from right center, line to bottom center, line to right center)';
         shapeOK = !!el.style.clipPath; }catch{}
    const cookieStoreOK = typeof window.cookieStore === 'object' && typeof cookieStore?.get === 'function';
    const webauthnOK =
      typeof window.PublicKeyCredential?.parseCreationOptionsFromJSON === 'function' &&
      typeof window.PublicKeyCredential?.parseRequestOptionsFromJSON === 'function' &&
      typeof window.PublicKeyCredential?.prototype?.toJSON === 'function';
    return { pass: !!(shapeOK && cookieStoreOK && webauthnOK), details:{shapeOK, cookieStoreOK, webauthnOK} };
  }

  // –ü–ò–ù-–æ—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ñ–∏—á–µ-—Å—Ç—Ä–æ–∫–∏ (–µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–µ—Ä–µ–∑–∞–ø–∏—à—É—Ç ‚Äî –≤–µ—Ä–Ω—ë–º –æ–±—Ä–∞—Ç–Ω–æ)
  function pinFeatures(lineHTML, detailsHTML){
    // –≤ note
    UI.n.innerHTML = lineHTML;
    // –∏ –ø—Ä–æ–¥—É–±–ª–∏—Ä—É–µ–º –≤ reason –ø–æ–¥ –ø—Ä–∏—á–∏–Ω–∞–º–∏ (—á—Ç–æ–±—ã —Ç–æ—á–Ω–æ —É–≤–∏–¥–µ—Ç—å –Ω–∞ –æ—Ç–∫–∞–∑–µ)
    const id = 'feat-details';
    const block = `<div id="${id}" style="margin-top:8px">${detailsHTML}</div>`;
    UI.r.insertAdjacentHTML('beforeend', block);

    const obs = new MutationObserver(() => {
      // –µ—Å–ª–∏ note —Å—Ç–µ—Ä–ª–∏ ‚Äî –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–º
      if (UI.n.textContent.trim() !== lineHTML.replace(/<[^>]+>/g,'')) UI.n.innerHTML = lineHTML;
      // –µ—Å–ª–∏ –¥–µ—Ç–∞–ª–∏ –ø—Ä–æ–ø–∞–ª–∏ ‚Äî –¥–æ–±–∞–≤–∏–º —Å–Ω–æ–≤–∞
      if (!document.getElementById(id)) UI.r.insertAdjacentHTML('beforeend', block);
    });
    obs.observe(UI.n, {childList:true, subtree:true});
    obs.observe(UI.r, {childList:true, subtree:false});
  }

  async function run(){
    // 1) —Ñ–∏—á–µ-—Ç–µ—Å—Ç—ã ‚Äî –ü–ï–†–í–´–ú–ò
    const [vt, t184] = await Promise.all([testVT18(), test184()]);
    const line = `<b>–§–∏—á–µ-—Ç–µ—Å—Ç—ã:</b> VT18=<b>${ok(vt.pass)}</b> ¬∑ 18.4=<b>${ok(t184.pass)}</b>`;
    const dets = `18.0 VT: API=${ok(vt.details.hasAPI)} CSS=${ok(vt.details.cssOK)} ran=${ok(vt.details.ran)} finished=${ok(vt.details.finished)}<br>
                  18.4: shape=${ok(t184.details.shapeOK)} cookieStore=${ok(t184.details.cookieStoreOK)} WebAuthnJSON=${ok(t184.details.webauthnOK)}`;
    pinFeatures(line, dets);

    // 2) –¥–∞–ª—å—à–µ –æ–±—ã—á–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã (–≤–∫–ª—é—á–∞—è app.js) –º–æ–≥—É—Ç –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞—Ç—å –ø—Ä–∏—á–∏–Ω—É/–∑–∞–≥–æ–ª–æ–≤–æ–∫ ‚Äî
    // –º—ã —É–∂–µ –∑–∞–∫—Ä–µ–ø–∏–ª–∏ —Å—Ç—Ä–æ–∫—É —Å —Ñ–∏—á–∞–º–∏ –∏ –¥–µ—Ç–∞–ª—è–º–∏.
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', run);
  } else {
    run();
  }
})();
</script>

<!-- –ê–Ω–∏–º–∞—Ü–∏–∏: —Å–Ω–µ–∂–∏–Ω–∫–∏ + –±–ª–∏–∫–∏ -->
<script>
const flakeSVG = `<svg viewBox="0 0 32 32" aria-hidden="true" focusable="false">
  <path d="M16 2v28M6 6l20 20M6 26l20-20 M2 16h28M10 4l2 6-6-2 M22 28l-2-6 6 2 M4 22l6-2-2 6 M28 10l-6 2 2-6"/></svg>`;
(function(){
  const wrap = document.getElementById('fireflies'); const count = 20; const flakes = []; const minDist = 12;
  function farEnough(x,y){ for (const f of flakes) if(Math.hypot(f.x-x,f.y-y)<minDist) return false; return true; }
  let tries=0;
  while(flakes.length<count && tries<2000){
    tries++; const x=Math.random()*100, y=Math.random()*100; if(!farEnough(x,y)) continue;
    const el=document.createElement('div'); el.className='flake'; el.innerHTML=flakeSVG;
    el.style.left=x+'vw'; el.style.top=y+'vh'; el.style.setProperty('--dur',(9+Math.random()*5)+'s');
    wrap.appendChild(el); flakes.push({el,x,y,homeLeft:el.style.left,homeTop:el.style.top});
  }
  const card=document.getElementById('card'); let drag=false; const radius=Math.min(innerWidth,innerHeight)*0.28;
  function attract(x,y){
    const vw=innerWidth,vh=innerHeight;
    for(const f of flakes){
      const r=f.el.getBoundingClientRect(); const cx=r.left+r.width/2, cy=r.top+r.height/2;
      if(Math.hypot(cx-x,cy-y)<=radius){ f.el.classList.add('glow'); f.el.style.left=(x/vw*100)+'vw'; f.el.style.top=(y/vh*100)+'vh'; }
    }
  }
  function release(){
    for(const f of flakes){
      if(f.el.classList.contains('glow')){
        setTimeout(()=>{ f.el.style.left=f.homeLeft; f.el.style.top=f.homeTop; setTimeout(()=>f.el.classList.remove('glow'),350); },200+Math.random()*350);
      }
    }
  }
  card.addEventListener('pointerdown', e=>{drag=true; attract(e.clientX,e.clientY);});
  card.addEventListener('pointermove', e=>{if(drag) attract(e.clientX,e.clientY);});
  ['pointerup','pointercancel','pointerleave'].forEach(ev=>card.addEventListener(ev,()=>{drag=false; release();}));
})();
(function(){
  const root = document.getElementById('sparkles'); const N = 24;
  for(let i=0;i<N;i++){ const s = document.createElement('span'); s.style.left = (Math.random()*100)+'%'; s.style.top=(Math.random()*100)+'%'; s.style.animationDelay=(Math.random()*6)+'s'; root.appendChild(s); }
})();
</script>

</body>
</html>
